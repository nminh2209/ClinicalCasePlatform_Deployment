# Environment Variables Template

## Backend (Render) Environment Variables

Copy these to Render Dashboard → Your Service → Environment:

```env
# Django Core Settings
DJANGO_SETTINGS_MODULE=clinical_case_platform.settings_production
SECRET_KEY=[CLICK GENERATE BUTTON IN RENDER]
DEBUG=False
PYTHON_VERSION=3.11.0

# Deployment URLs
ALLOWED_HOSTS=clinical-case-api.onrender.com,your-custom-domain.com
CORS_ALLOWED_ORIGINS=https://your-app.vercel.app,https://your-custom-domain.com
CSRF_TRUSTED_ORIGINS=https://clinical-case-api.onrender.com,https://your-app.vercel.app

# Database (Auto-linked in Render)
DATABASE_URL=[Link to PostgreSQL database in Render]

# Media Storage - Option 1: Local (Not recommended for production)
USE_S3=FALSE

# Media Storage - Option 2: AWS S3 (Recommended)
# Uncomment these if using S3:
# USE_S3=TRUE
# AWS_ACCESS_KEY_ID=your-aws-access-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret-key
# AWS_STORAGE_BUCKET_NAME=clinical-case-media
# AWS_S3_REGION_NAME=ap-southeast-1

# Email Configuration - Option 1: Console (Development)
# (No variables needed - uses console backend by default)

# Email Configuration - Option 2: SendGrid (Production)
# EMAIL_HOST=smtp.sendgrid.net
# EMAIL_PORT=587
# EMAIL_USE_TLS=True
# EMAIL_HOST_USER=apikey
# EMAIL_HOST_PASSWORD=your-sendgrid-api-key
# DEFAULT_FROM_EMAIL=noreply@yourdomain.com

# Email Configuration - Option 3: AWS SES
# EMAIL_HOST=email-smtp.ap-southeast-1.amazonaws.com
# EMAIL_PORT=587
# EMAIL_USE_TLS=True
# EMAIL_HOST_USER=your-ses-smtp-username
# EMAIL_HOST_PASSWORD=your-ses-smtp-password
# DEFAULT_FROM_EMAIL=noreply@yourdomain.com

# Logging (Optional)
# DJANGO_LOG_LEVEL=INFO
```

---

## Frontend (Vercel) Environment Variables

Copy these to Vercel Dashboard → Your Project → Settings → Environment Variables:

```env
# API Configuration
VITE_API_URL=https://clinical-case-api.onrender.com

# App Configuration
VITE_APP_NAME=Clinical Case Platform
VITE_APP_ENV=production

# Optional: Analytics (if using Google Analytics)
# VITE_GA_TRACKING_ID=G-XXXXXXXXXX

# Optional: Sentry Error Tracking
# VITE_SENTRY_DSN=https://xxxxx@xxxxx.ingest.sentry.io/xxxxx
```

---

## Local Development (.env)

For local development, create `backend/.env`:

```env
# Django
SECRET_KEY=django-insecure-local-dev-key-change-in-production
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1

# Database (Local PostgreSQL)
DATABASE_URL=postgresql://postgres:password@localhost:5432/clinical_case_platform

# CORS (Allow local frontend)
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://127.0.0.1:5173

# Media
USE_S3=FALSE
```

For frontend, create `frontend/.env.local`:

```env
VITE_API_URL=http://localhost:8000
VITE_APP_NAME=Clinical Case Platform (Dev)
VITE_APP_ENV=development
```

---

## How to Generate SECRET_KEY

Run this in Python:

```python
python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
```

Or use Render's "Generate" button for the SECRET_KEY variable.

---

## Important Notes

### 1. **Never commit `.env` files to Git**
   - Already in `.gitignore`
   - Use `.env.example` for templates

### 2. **Update CORS after deploying frontend**
   - First deploy backend
   - Then deploy frontend
   - Copy Vercel URL
   - Update `CORS_ALLOWED_ORIGINS` in Render
   - Redeploy backend

### 3. **Database URL Format**
   ```
   postgresql://username:password@hostname:port/database
   ```

### 4. **Multiple URLs in Environment Variables**
   - Separate with commas (no spaces):
   ```
   CORS_ALLOWED_ORIGINS=https://app1.com,https://app2.com
   ```

### 5. **Testing Environment Variables**
   - Backend: Check `/api/health/` endpoint
   - Frontend: Check browser console for API errors
   - Database: Create a test case

---

## Security Checklist

- [x] Different SECRET_KEY for production
- [x] DEBUG=False in production
- [x] HTTPS enforced (automatic on Render/Vercel)
- [x] CORS restricted to known origins
- [x] Database password strong (auto-generated by Render)
- [ ] Consider adding rate limiting
- [ ] Consider adding error tracking (Sentry)
- [ ] Regular security updates

---

## Troubleshooting

### Can't connect to database
- Check `DATABASE_URL` is correct
- Verify database is in same region as web service
- Check database is running (Render dashboard)

### CORS errors
- Ensure no trailing slash in `CORS_ALLOWED_ORIGINS`
- Check exact URL match (http vs https)
- Verify `django-cors-headers` is installed

### Static files not loading
- Run `python manage.py collectstatic`
- Check `STATIC_ROOT` in settings
- Verify WhiteNoise is configured

### Email not sending
- Check email configuration variables
- Verify SMTP credentials
- Check email provider settings
