# Generated by Django 5.2.9 on 2026-01-05 00:23

import cases.medical_models
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='CaseAnalytics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('total_views', models.PositiveIntegerField(default=0, help_text='Tổng số lượt xem')),
                ('unique_viewers', models.PositiveIntegerField(default=0, help_text='Số người xem duy nhất')),
                ('average_time_spent_seconds', models.PositiveIntegerField(default=0, help_text='Thời gian xem trung bình (giây)')),
                ('completion_rate', models.FloatField(default=0.0, help_text='Tỷ lệ hoàn thành (%)')),
                ('total_comments', models.PositiveIntegerField(default=0, help_text='Tổng số bình luận')),
                ('total_feedback', models.PositiveIntegerField(default=0, help_text='Tổng số phản hồi từ giảng viên')),
                ('total_shares', models.PositiveIntegerField(default=0, help_text='Số lần chia sẻ')),
                ('bookmark_count', models.PositiveIntegerField(default=0, help_text='Số lần đánh dấu')),
                ('average_grade', models.FloatField(blank=True, help_text='Điểm trung bình', null=True)),
                ('pass_rate', models.FloatField(default=0.0, help_text='Tỷ lệ đạt (%)')),
                ('learning_objective_achievement', models.FloatField(default=0.0, help_text='Tỷ lệ đạt mục tiêu học tập (%)')),
                ('average_rating', models.FloatField(blank=True, help_text='Đánh giá trung bình (1-5)', null=True)),
                ('difficulty_rating', models.FloatField(blank=True, help_text='Đánh giá độ khó (1-5)', null=True)),
                ('relevance_rating', models.FloatField(blank=True, help_text='Đánh giá mức độ liên quan (1-5)', null=True)),
                ('last_viewed_at', models.DateTimeField(blank=True, help_text='Lần xem cuối', null=True)),
                ('last_updated_at', models.DateTimeField(auto_now=True, help_text='Lần cập nhật analytics cuối')),
            ],
            options={
                'verbose_name': 'Case Analytics',
                'verbose_name_plural': 'Case Analytics',
                'db_table': 'cases_caseanalytics',
            },
        ),
        migrations.CreateModel(
            name='CaseComplexityLevel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50, unique=True, verbose_name='Tên mức độ phức tạp')),
                ('key', models.SlugField(help_text='Khóa duy nhất để sử dụng trong code (ví dụ: easy, medium, hard, very_hard)', unique=True, verbose_name='Khóa')),
                ('description', models.TextField(blank=True, verbose_name='Mô tả')),
                ('is_active', models.BooleanField(default=True, verbose_name='Đang hoạt động')),
                ('display_order', models.PositiveIntegerField(default=0, verbose_name='Thứ tự hiển thị')),
            ],
            options={
                'verbose_name': 'Mức độ phức tạp',
                'verbose_name_plural': 'Mức độ phức tạp',
                'db_table': 'case_complexity_levels',
                'ordering': ['display_order'],
            },
        ),
        migrations.CreateModel(
            name='CaseGroup',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Tên nhóm ca bệnh', max_length=200)),
                ('description', models.TextField(blank=True, help_text='Mô tả')),
                ('group_type', models.CharField(choices=[('department', 'Bộ sưu tập khoa'), ('class', 'Bộ sưu tập lớp'), ('assignment', 'Bài tập'), ('curriculum', 'Chương trình học')], default='assignment', max_length=20)),
                ('class_identifier', models.CharField(blank=True, help_text='Mã lớp (VD: K15Y1, Y6-ICU, etc.)', max_length=100)),
                ('is_active', models.BooleanField(default=True)),
                ('is_public', models.BooleanField(default=False, help_text='Nhóm công khai (tất cả có thể xem)')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Nhóm ca bệnh',
                'verbose_name_plural': 'Nhóm ca bệnh',
                'db_table': 'cases_casegroup',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CasePermission',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('share_type', models.CharField(choices=[('individual', 'Cá nhân'), ('department', 'Khoa phòng'), ('class_group', 'Lớp học'), ('public', 'Công khai')], default='individual', help_text='Loại chia sẻ', max_length=20)),
                ('class_group', models.CharField(blank=True, help_text='Nhóm lớp học (VD: K15, Y6, etc.)', max_length=100)),
                ('permission_type', models.CharField(choices=[('view', 'Chỉ xem'), ('comment', 'Xem và bình luận'), ('analyze', 'Xem, bình luận và phân tích'), ('edit', 'Toàn quyền chỉnh sửa')], default='view', max_length=20)),
                ('granted_at', models.DateTimeField(auto_now_add=True)),
                ('expires_at', models.DateTimeField(blank=True, help_text='Thời gian hết hạn (để trống nếu không giới hạn)', null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True, help_text='Ghi chú về quyền truy cập này')),
                ('access_count', models.PositiveIntegerField(default=0, help_text='Số lần truy cập')),
                ('last_accessed', models.DateTimeField(blank=True, help_text='Lần cuối truy cập', null=True)),
            ],
            options={
                'verbose_name': 'Quyền truy cập ca bệnh',
                'verbose_name_plural': 'Quyền truy cập ca bệnh',
                'db_table': 'cases_casepermission',
            },
        ),
        migrations.CreateModel(
            name='CasePriorityLevel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50, unique=True, verbose_name='Tên mức độ ưu tiên')),
                ('key', models.SlugField(help_text='Khóa duy nhất để sử dụng trong code (ví dụ: low, medium, high, urgent)', unique=True, verbose_name='Khóa')),
                ('color', models.CharField(default='gray', help_text='Màu để hiển thị trong giao diện (red, yellow, green, gray, blue)', max_length=20, verbose_name='Màu hiển thị')),
                ('is_active', models.BooleanField(default=True, verbose_name='Đang hoạt động')),
                ('display_order', models.PositiveIntegerField(default=0, verbose_name='Thứ tự hiển thị')),
            ],
            options={
                'verbose_name': 'Mức độ ưu tiên',
                'verbose_name_plural': 'Mức độ ưu tiên',
                'db_table': 'case_priority_levels',
                'ordering': ['display_order'],
            },
        ),
        migrations.CreateModel(
            name='CaseQualityMetrics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('clinical_history_completeness', models.FloatField(default=0.0, help_text='Độ hoàn thiện tiền sử lâm sàng')),
                ('examination_completeness', models.FloatField(default=0.0, help_text='Độ hoàn thiện khám lâm sàng')),
                ('investigation_completeness', models.FloatField(default=0.0, help_text='Độ hoàn thiện xét nghiệm')),
                ('diagnosis_completeness', models.FloatField(default=0.0, help_text='Độ hoàn thiện chẩn đoán')),
                ('learning_objectives_completeness', models.FloatField(default=0.0, help_text='Độ hoàn thiện mục tiêu học tập')),
                ('has_attachments', models.BooleanField(default=False, help_text='Có tệp đính kèm')),
                ('attachment_quality_score', models.FloatField(default=0.0, help_text='Điểm chất lượng tệp đính kèm')),
                ('terminology_accuracy', models.FloatField(default=0.0, help_text='Độ chính xác thuật ngữ')),
                ('vietnamese_language_quality', models.FloatField(default=0.0, help_text='Chất lượng tiếng Việt')),
                ('overall_completeness', models.FloatField(default=0.0, help_text='Độ hoàn thiện tổng thể')),
                ('overall_quality', models.FloatField(default=0.0, help_text='Chất lượng tổng thể')),
                ('last_calculated_at', models.DateTimeField(auto_now=True, help_text='Lần tính toán cuối')),
            ],
            options={
                'verbose_name': 'Case Quality Metrics',
                'verbose_name_plural': 'Case Quality Metrics',
                'db_table': 'cases_casequalitymetrics',
            },
        ),
        migrations.CreateModel(
            name='CaseSubmissionWorkflow',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('current_status', models.CharField(choices=[('draft', 'Bản nháp'), ('validation_pending', 'Đang kiểm tra'), ('validation_failed', 'Kiểm tra không đạt'), ('submitted', 'Đã nộp'), ('under_review', 'Đang xem xét'), ('revision_requested', 'Yêu cầu sửa'), ('approved', 'Đã phê duyệt'), ('rejected', 'Từ chối'), ('published', 'Đã xuất bản')], default='draft', help_text='Trạng thái hiện tại', max_length=50)),
                ('submitted_at', models.DateTimeField(blank=True, help_text='Thời gian nộp', null=True)),
                ('review_started_at', models.DateTimeField(blank=True, help_text='Thời gian bắt đầu xem xét', null=True)),
                ('review_completed_at', models.DateTimeField(blank=True, help_text='Thời gian hoàn thành xem xét', null=True)),
                ('approved_at', models.DateTimeField(blank=True, help_text='Thời gian phê duyệt', null=True)),
                ('revision_count', models.PositiveIntegerField(default=0, help_text='Số lần yêu cầu sửa')),
                ('revision_notes', models.TextField(blank=True, help_text='Ghi chú yêu cầu sửa')),
                ('last_revision_requested_at', models.DateTimeField(blank=True, help_text='Lần cuối yêu cầu sửa', null=True)),
                ('rejected_at', models.DateTimeField(blank=True, help_text='Thời gian từ chối', null=True)),
                ('rejection_reason', models.TextField(blank=True, help_text='Lý do từ chối')),
                ('workflow_history', models.JSONField(default=list, help_text='Lịch sử thay đổi trạng thái')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Case Submission Workflow',
                'verbose_name_plural': 'Case Submission Workflows',
                'db_table': 'cases_casesubmissionworkflow',
                'ordering': ['-updated_at'],
            },
        ),
        migrations.CreateModel(
            name='CaseValidationResult',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('validation_status', models.CharField(choices=[('passed', 'Đạt'), ('failed', 'Không đạt'), ('warning', 'Cảnh báo'), ('pending', 'Đang chờ')], default='pending', help_text='Trạng thái kiểm tra', max_length=20)),
                ('total_rules_checked', models.PositiveIntegerField(default=0, help_text='Tổng số quy tắc kiểm tra')),
                ('rules_passed', models.PositiveIntegerField(default=0, help_text='Số quy tắc đạt')),
                ('rules_failed', models.PositiveIntegerField(default=0, help_text='Số quy tắc không đạt')),
                ('warnings_count', models.PositiveIntegerField(default=0, help_text='Số cảnh báo')),
                ('validation_issues', models.JSONField(default=list, help_text='Danh sách vấn đề tìm thấy')),
                ('completeness_score', models.FloatField(default=0.0, help_text='Điểm độ hoàn thiện (0-100)')),
                ('quality_score', models.FloatField(default=0.0, help_text='Điểm chất lượng (0-100)')),
                ('overall_score', models.FloatField(default=0.0, help_text='Điểm tổng thể (0-100)')),
                ('validated_at', models.DateTimeField(auto_now_add=True, help_text='Thời gian kiểm tra')),
                ('validation_type', models.CharField(choices=[('automatic', 'Tự động'), ('manual', 'Thủ công'), ('pre_submission', 'Trước khi nộp'), ('review', 'Xem xét')], default='automatic', help_text='Loại kiểm tra', max_length=50)),
            ],
            options={
                'verbose_name': 'Case Validation Result',
                'verbose_name_plural': 'Case Validation Results',
                'db_table': 'cases_casevalidationresult',
                'ordering': ['-validated_at'],
            },
        ),
        migrations.CreateModel(
            name='CaseValidationRule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Tên quy tắc', max_length=200)),
                ('rule_type', models.CharField(choices=[('required_field', 'Trường bắt buộc'), ('min_length', 'Độ dài tối thiểu'), ('max_length', 'Độ dài tối đa'), ('pattern_match', 'Khớp mẫu'), ('attachment_required', 'Yêu cầu tệp đính kèm'), ('terminology_check', 'Kiểm tra thuật ngữ'), ('learning_objective', 'Mục tiêu học tập')], help_text='Loại quy tắc', max_length=50)),
                ('severity', models.CharField(choices=[('error', 'Lỗi (chặn nộp)'), ('warning', 'Cảnh báo'), ('info', 'Thông tin')], default='error', help_text='Mức độ nghiêm trọng', max_length=20)),
                ('target_field', models.CharField(help_text='Trường áp dụng (VD: title, diagnosis, clinical_history.chief_complaint)', max_length=100)),
                ('rule_config', models.JSONField(default=dict, help_text='Cấu hình quy tắc (min_length, pattern, etc.)')),
                ('applies_to_specialties', models.JSONField(default=list, help_text='Áp dụng cho các chuyên khoa cụ thể')),
                ('is_active', models.BooleanField(default=True, help_text='Quy tắc đang hoạt động')),
                ('error_message_vi', models.TextField(help_text='Thông báo lỗi (tiếng Việt)')),
                ('error_message_en', models.TextField(blank=True, help_text='Thông báo lỗi (tiếng Anh)')),
                ('help_text', models.TextField(blank=True, help_text='Hướng dẫn khắc phục')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Case Validation Rule',
                'verbose_name_plural': 'Case Validation Rules',
                'db_table': 'cases_casevalidationrule',
                'ordering': ['severity', 'name'],
            },
        ),
        migrations.CreateModel(
            name='CaseViewLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('viewed_at', models.DateTimeField(auto_now_add=True, help_text='Thời gian xem')),
                ('time_spent_seconds', models.PositiveIntegerField(default=0, help_text='Thời gian xem (giây)')),
                ('completed', models.BooleanField(default=False, help_text='Đã xem hết')),
                ('access_method', models.CharField(choices=[('direct', 'Trực tiếp'), ('search', 'Tìm kiếm'), ('shared', 'Chia sẻ'), ('assignment', 'Bài tập')], default='direct', help_text='Phương thức truy cập', max_length=50)),
                ('device_type', models.CharField(blank=True, help_text='Loại thiết bị', max_length=50)),
                ('ip_address', models.GenericIPAddressField(blank=True, help_text='Địa chỉ IP', null=True)),
            ],
            options={
                'verbose_name': 'Case View Log',
                'verbose_name_plural': 'Case View Logs',
                'db_table': 'cases_caseviewlog',
                'ordering': ['-viewed_at'],
            },
        ),
        migrations.CreateModel(
            name='ClinicalHistory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('chief_complaint', models.TextField(help_text='Lý do chính đến khám')),
                ('history_present_illness', models.TextField(help_text='Tiền sử bệnh hiện tại')),
                ('symptom_duration_days', models.PositiveIntegerField(blank=True, help_text='Thời gian có triệu chứng (ngày)', null=True)),
                ('symptom_onset', models.CharField(blank=True, choices=[('sudden', 'Đột ngột'), ('gradual', 'Từ từ'), ('chronic', 'Mạn tính')], help_text='Khởi phát triệu chứng', max_length=50)),
                ('symptom_progression', models.CharField(blank=True, choices=[('improving', 'Cải thiện'), ('worsening', 'Xấu đi'), ('stable', 'Ổn định'), ('fluctuating', 'Biến đổi')], help_text='Diễn biến triệu chứng', max_length=50)),
                ('past_medical_history', models.TextField(blank=True, help_text='Tiền sử bệnh tật')),
                ('family_history', models.TextField(blank=True, help_text='Tiền sử gia đình')),
                ('social_history', models.TextField(blank=True, help_text='Tiền sử xã hội (hút thuốc, uống rượu, v.v.)')),
                ('allergies', models.TextField(blank=True, help_text='Dị ứng')),
                ('medications', models.TextField(blank=True, help_text='Thuốc đang sử dụng')),
                ('review_systems', models.TextField(blank=True, help_text='Hỏi bệnh theo hệ thống')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Clinical History',
                'verbose_name_plural': 'Clinical Histories',
                'db_table': 'cases_clinicalhistory',
            },
        ),
        migrations.CreateModel(
            name='Department',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, unique=True)),
                ('code', models.CharField(max_length=20, unique=True)),
                ('vietnamese_name', models.CharField(blank=True, help_text='Tên tiếng Việt', max_length=100)),
                ('description', models.TextField(blank=True)),
                ('location', models.CharField(blank=True, max_length=200)),
                ('head_of_department', models.CharField(blank=True, max_length=200)),
                ('contact_email', models.EmailField(blank=True, help_text='Email liên hệ', max_length=254)),
                ('department_type', models.CharField(choices=[('clinical', 'Lâm sàng'), ('paraclinical', 'Cận lâm sàng'), ('administrative', 'Hành chính')], default='clinical', help_text='Loại khoa phòng', max_length=50)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'db_table': 'cases_department',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='DepartmentAnalytics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('period_start', models.DateField(help_text='Ngày bắt đầu chu kỳ')),
                ('period_end', models.DateField(help_text='Ngày kết thúc chu kỳ')),
                ('total_students', models.PositiveIntegerField(default=0, help_text='Tổng số sinh viên')),
                ('total_instructors', models.PositiveIntegerField(default=0, help_text='Tổng số giảng viên')),
                ('active_students', models.PositiveIntegerField(default=0, help_text='Số sinh viên hoạt động')),
                ('total_cases', models.PositiveIntegerField(default=0, help_text='Tổng số ca bệnh')),
                ('cases_submitted', models.PositiveIntegerField(default=0, help_text='Số ca bệnh đã nộp')),
                ('cases_reviewed', models.PositiveIntegerField(default=0, help_text='Số ca bệnh đã xem xét')),
                ('average_grade', models.FloatField(blank=True, help_text='Điểm trung bình', null=True)),
                ('pass_rate', models.FloatField(default=0.0, help_text='Tỷ lệ đạt (%)')),
                ('average_completion_rate', models.FloatField(default=0.0, help_text='Tỷ lệ hoàn thành trung bình (%)')),
                ('total_comments', models.PositiveIntegerField(default=0, help_text='Tổng số bình luận')),
                ('total_feedback', models.PositiveIntegerField(default=0, help_text='Tổng số phản hồi')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Department Analytics',
                'verbose_name_plural': 'Department Analytics',
                'db_table': 'cases_departmentanalytics',
                'ordering': ['-period_start'],
            },
        ),
        migrations.CreateModel(
            name='DiagnosisManagement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('primary_diagnosis', models.TextField(help_text='Chẩn đoán chính')),
                ('differential_diagnosis', models.TextField(blank=True, help_text='Chẩn đoán phân biệt')),
                ('icd10_codes', models.CharField(blank=True, help_text='Mã ICD-10', max_length=200)),
                ('treatment_plan', models.TextField(help_text='Kế hoạch điều trị')),
                ('medications_prescribed', models.TextField(blank=True, help_text='Thuốc được kê đơn')),
                ('procedures_performed', models.TextField(blank=True, help_text='Các thủ thuật đã thực hiện')),
                ('follow_up_plan', models.TextField(blank=True, help_text='Kế hoạch theo dõi')),
                ('prognosis', models.TextField(blank=True, help_text='Tiên lượng')),
                ('complications', models.TextField(blank=True, help_text='Biến chứng')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Diagnosis & Management',
                'verbose_name_plural': 'Diagnosis & Management',
                'db_table': 'cases_diagnosismanagement',
            },
        ),
        migrations.CreateModel(
            name='GuestAccess',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('access_token', models.CharField(help_text='Token truy cập duy nhất cho khách', max_length=255, unique=True)),
                ('guest_email', models.EmailField(help_text='Email người được mời', max_length=254)),
                ('guest_name', models.CharField(blank=True, help_text='Tên người được mời', max_length=200)),
                ('permission_type', models.CharField(choices=[('view', 'Chỉ xem'), ('comment', 'Xem và bình luận'), ('analyze', 'Xem, bình luận và phân tích'), ('edit', 'Toàn quyền chỉnh sửa')], default='view', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('expires_at', models.DateTimeField(help_text='Thời gian hết hạn (bắt buộc)')),
                ('is_active', models.BooleanField(default=True)),
                ('access_count', models.PositiveIntegerField(default=0)),
                ('last_accessed', models.DateTimeField(blank=True, null=True)),
                ('accessed_ips', models.JSONField(default=list, help_text='Danh sách IP đã truy cập')),
            ],
            options={
                'verbose_name': 'Truy cập khách',
                'verbose_name_plural': 'Truy cập khách',
                'db_table': 'cases_guestaccess',
            },
        ),
        migrations.CreateModel(
            name='ICD10Code',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(max_length=12, unique=True)),
                ('description_en', models.TextField(blank=True)),
                ('description_vi', models.TextField(blank=True)),
                ('chapter', models.CharField(blank=True, max_length=100)),
                ('category', models.CharField(blank=True, max_length=100)),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'db_table': 'cases_icd10code',
                'ordering': ['code'],
            },
        ),
        migrations.CreateModel(
            name='InstructorCaseAuditLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action', models.CharField(choices=[('created', 'Created'), ('modified', 'Modified'), ('deleted', 'Deleted')], help_text='Type of action performed', max_length=20)),
                ('changes', models.JSONField(default=dict, help_text='JSON object containing the changed fields and their values')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Instructor Case Audit Log',
                'verbose_name_plural': 'Instructor Case Audit Logs',
                'db_table': 'cases_instructorcaseauditlog',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Investigations',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('laboratory_results', models.TextField(blank=True, help_text='Kết quả xét nghiệm tổng quát')),
                ('hemoglobin_level', models.FloatField(blank=True, help_text='Hemoglobin (g/dL)', null=True)),
                ('white_cell_count', models.FloatField(blank=True, help_text='Bạch cầu (10^9/L)', null=True)),
                ('platelet_count', models.FloatField(blank=True, help_text='Tiểu cầu (10^9/L)', null=True)),
                ('sodium_level', models.FloatField(blank=True, help_text='Natri (mmol/L)', null=True)),
                ('potassium_level', models.FloatField(blank=True, help_text='Kali (mmol/L)', null=True)),
                ('glucose_level', models.FloatField(blank=True, help_text='Glucose (mg/dL)', null=True)),
                ('creatinine_level', models.FloatField(blank=True, help_text='Creatinine (mg/dL)', null=True)),
                ('imaging_studies', models.TextField(blank=True, help_text='Chẩn đoán hình ảnh (X-quang, CT, MRI, siêu âm)')),
                ('ecg_findings', models.TextField(blank=True, help_text='Điện tim')),
                ('ecg_rhythm', models.CharField(blank=True, help_text='Nhịp điện tim (sinus, AF, etc.)', max_length=50)),
                ('ecg_rate', models.PositiveIntegerField(blank=True, help_text='Tần số điện tim (bpm)', null=True)),
                ('pathology_results', models.TextField(blank=True, help_text='Kết quả giải phẫu bệnh')),
                ('microbiology_results', models.TextField(blank=True, help_text='Kết quả vi sinh')),
                ('other_investigations', models.TextField(blank=True, help_text='Xét nghiệm khác')),
                ('arterial_blood_gas', models.TextField(blank=True, help_text='Khí máu động mạch')),
                ('ph_level', models.FloatField(blank=True, help_text='pH máu', null=True)),
                ('special_tests', models.TextField(blank=True, help_text='Các xét nghiệm đặc biệt')),
                ('microbiology', models.TextField(blank=True, help_text='Vi sinh')),
                ('biochemistry', models.TextField(blank=True, help_text='Sinh hóa')),
                ('hematology', models.TextField(blank=True, help_text='Huyết học')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Investigation',
                'verbose_name_plural': 'Investigations',
                'db_table': 'cases_investigations',
            },
        ),
        migrations.CreateModel(
            name='LearningOutcomes',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('learning_objectives', models.TextField(help_text='Mục tiêu học tập')),
                ('key_concepts', models.TextField(blank=True, help_text='Khái niệm chính')),
                ('clinical_pearls', models.TextField(blank=True, help_text='Kinh nghiệm lâm sàng')),
                ('references', models.TextField(blank=True, help_text='Tài liệu tham khảo')),
                ('discussion_points', models.TextField(blank=True, help_text='Điểm thảo luận')),
                ('assessment_criteria', models.TextField(blank=True, help_text='Tiêu chí đánh giá')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Learning Outcome',
                'verbose_name_plural': 'Learning Outcomes',
                'db_table': 'cases_learningoutcomes',
            },
        ),
        migrations.CreateModel(
            name='MedicalAbbreviation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('abbr', models.CharField(max_length=64, unique=True)),
                ('expansion', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('specialty', models.CharField(blank=True, max_length=100)),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'db_table': 'cases_medicalabbreviation',
            },
        ),
        migrations.CreateModel(
            name='MedicalAttachment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('file', models.FileField(help_text='Tệp đính kèm y tế', upload_to=cases.medical_models.medical_attachment_upload_to)),
                ('attachment_type', models.CharField(choices=[('xray', 'Ảnh chụp X-quang'), ('ct_scan', 'Ảnh chụp CT'), ('mri', 'Ảnh chụp MRI'), ('ultrasound', 'Ảnh siêu âm'), ('ecg', 'Điện tim đồ'), ('lab_report', 'Phiếu xét nghiệm'), ('blood_test', 'Kết quả xét nghiệm máu'), ('urine_test', 'Kết quả xét nghiệm nước tiểu'), ('pathology', 'Kết quả giải phẫu bệnh'), ('injury_photo', 'Ảnh chụp chấn thương'), ('surgical_photo', 'Ảnh phẫu thuật'), ('endoscopy', 'Ảnh nội soi'), ('prescription', 'Đơn thuốc'), ('discharge_summary', 'Tóm tắt xuất viện'), ('consent_form', 'Phiếu đồng ý'), ('other', 'Khác')], help_text='Loại tệp đính kèm', max_length=50)),
                ('title', models.CharField(help_text='Tiêu đề mô tả tệp', max_length=200)),
                ('description', models.TextField(blank=True, help_text='Mô tả chi tiết về tệp')),
                ('date_taken', models.DateTimeField(blank=True, help_text='Ngày chụp/thực hiện', null=True)),
                ('physician_notes', models.TextField(blank=True, help_text='Ghi chú của bác sĩ')),
                ('file_size', models.BigIntegerField(blank=True, help_text='Kích thước tệp (bytes)', null=True)),
                ('file_type', models.CharField(blank=True, help_text='Loại tệp (MIME type)', max_length=200)),
                ('uploaded_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('confidentiality_level', models.CharField(choices=[('public', 'Public (all collaborators)'), ('confidential', 'Confidential (instructors + owner)'), ('restricted', 'Restricted (owner + designated instructors)'), ('department', 'Department only')], default='public', help_text='Mức độ bảo mật của tệp', max_length=50)),
            ],
            options={
                'verbose_name': 'Medical Attachment',
                'verbose_name_plural': 'Medical Attachments',
                'db_table': 'cases_medicalattachment',
                'ordering': ['-uploaded_at'],
            },
        ),
        migrations.CreateModel(
            name='MedicalTerm',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('term', models.CharField(help_text='Canonical term (prefer Vietnamese)', max_length=255)),
                ('vietnamese_term', models.CharField(blank=True, max_length=255)),
                ('english_term', models.CharField(blank=True, max_length=255)),
                ('synonyms', models.JSONField(blank=True, default=list, help_text='List of alternative terms/synonyms')),
                ('definition', models.TextField(blank=True)),
                ('specialty', models.CharField(blank=True, help_text='Medical specialty tag', max_length=100)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'db_table': 'cases_medicalterm',
            },
        ),
        migrations.CreateModel(
            name='MedicalTerminologyCheck',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('term', models.CharField(help_text='Thuật ngữ y khoa', max_length=200, unique=True)),
                ('vietnamese_term', models.CharField(help_text='Thuật ngữ tiếng Việt', max_length=200)),
                ('category', models.CharField(help_text='Danh mục (VD: Anatomy, Disease, Procedure)', max_length=100)),
                ('definition', models.TextField(blank=True, help_text='Định nghĩa')),
                ('synonyms', models.JSONField(default=list, help_text='Từ đồng nghĩa')),
                ('is_approved', models.BooleanField(default=True, help_text='Thuật ngữ được phê duyệt')),
                ('requires_context', models.BooleanField(default=False, help_text='Yêu cầu ngữ cảnh cụ thể')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Medical Terminology',
                'verbose_name_plural': 'Medical Terminologies',
                'db_table': 'cases_medicalterminologycheck',
                'ordering': ['term'],
            },
        ),
        migrations.CreateModel(
            name='PermissionAuditLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action', models.CharField(choices=[('granted', 'Cấp quyền'), ('revoked', 'Thu hồi quyền'), ('modified', 'Thay đổi quyền'), ('accessed', 'Truy cập'), ('expired', 'Hết hạn')], help_text='Hành động được thực hiện', max_length=20)),
                ('permission_type', models.CharField(blank=True, choices=[('view', 'Chỉ xem'), ('comment', 'Xem và bình luận'), ('analyze', 'Xem, bình luận và phân tích'), ('edit', 'Toàn quyền chỉnh sửa')], help_text='Loại quyền', max_length=20)),
                ('description', models.TextField(blank=True, help_text='Mô tả chi tiết hành động')),
                ('ip_address', models.GenericIPAddressField(blank=True, help_text='Địa chỉ IP', null=True)),
                ('user_agent', models.TextField(blank=True, help_text='Thông tin trình duyệt/thiết bị')),
                ('additional_data', models.JSONField(default=dict, help_text='Dữ liệu bổ sung')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Nhật ký kiểm toán quyền',
                'verbose_name_plural': 'Nhật ký kiểm toán quyền',
                'db_table': 'cases_permissionauditlog',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='PhysicalExamination',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('general_appearance', models.TextField(help_text='Thể trạng chung')),
                ('consciousness_level', models.CharField(choices=[('alert', 'Tỉnh táo'), ('drowsy', 'Lơ mơ'), ('stupor', 'Hôn mê nông'), ('coma', 'Hôn mê sâu')], default='alert', help_text='Mức độ ý thức', max_length=50)),
                ('vital_signs', models.TextField(help_text='Dấu hiệu sinh tồn tổng hợp')),
                ('vital_signs_bp', models.CharField(blank=True, help_text='Huyết áp (mmHg)', max_length=20)),
                ('vital_signs_hr', models.PositiveIntegerField(blank=True, help_text='Nhịp tim (lần/phút)', null=True)),
                ('vital_signs_rr', models.PositiveIntegerField(blank=True, help_text='Nhịp thở (lần/phút)', null=True)),
                ('vital_signs_temp', models.FloatField(blank=True, help_text='Nhiệt độ (°C)', null=True)),
                ('vital_signs_spo2', models.PositiveIntegerField(blank=True, help_text='SpO2 (%)', null=True)),
                ('height_cm', models.FloatField(blank=True, help_text='Chiều cao (cm)', null=True)),
                ('weight_kg', models.FloatField(blank=True, help_text='Cân nặng (kg)', null=True)),
                ('bmi', models.FloatField(blank=True, help_text='Chỉ số BMI', null=True)),
                ('head_neck', models.TextField(blank=True, help_text='Đầu và cổ')),
                ('cardiovascular', models.TextField(blank=True, help_text='Tim mạch')),
                ('respiratory', models.TextField(blank=True, help_text='Hô hấp')),
                ('abdominal', models.TextField(blank=True, help_text='Bụng')),
                ('neurological', models.TextField(blank=True, help_text='Thần kinh')),
                ('musculoskeletal', models.TextField(blank=True, help_text='Cơ xương khớp')),
                ('skin', models.TextField(blank=True, help_text='Da')),
                ('other_systems', models.TextField(blank=True, help_text='Các hệ khác')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Physical Examination',
                'verbose_name_plural': 'Physical Examinations',
                'db_table': 'cases_physicalexamination',
            },
        ),
        migrations.CreateModel(
            name='PlatformUsageStatistics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('period_type', models.CharField(choices=[('daily', 'Hàng ngày'), ('weekly', 'Hàng tuần'), ('monthly', 'Hàng tháng')], help_text='Loại chu kỳ', max_length=20)),
                ('period_start', models.DateField(help_text='Ngày bắt đầu chu kỳ')),
                ('period_end', models.DateField(help_text='Ngày kết thúc chu kỳ')),
                ('total_active_users', models.PositiveIntegerField(default=0, help_text='Tổng số người dùng hoạt động')),
                ('total_active_students', models.PositiveIntegerField(default=0, help_text='Tổng số sinh viên hoạt động')),
                ('total_active_instructors', models.PositiveIntegerField(default=0, help_text='Tổng số giảng viên hoạt động')),
                ('new_users', models.PositiveIntegerField(default=0, help_text='Số người dùng mới')),
                ('total_cases_created', models.PositiveIntegerField(default=0, help_text='Tổng số ca bệnh tạo mới')),
                ('total_cases_submitted', models.PositiveIntegerField(default=0, help_text='Tổng số ca bệnh nộp')),
                ('total_cases_reviewed', models.PositiveIntegerField(default=0, help_text='Tổng số ca bệnh xem xét')),
                ('total_case_views', models.PositiveIntegerField(default=0, help_text='Tổng số lượt xem ca bệnh')),
                ('total_comments', models.PositiveIntegerField(default=0, help_text='Tổng số bình luận')),
                ('total_feedback', models.PositiveIntegerField(default=0, help_text='Tổng số phản hồi')),
                ('total_grades_given', models.PositiveIntegerField(default=0, help_text='Tổng số điểm đã chấm')),
                ('average_grade', models.FloatField(blank=True, help_text='Điểm trung bình', null=True)),
                ('average_completion_time_hours', models.FloatField(blank=True, help_text='Thời gian hoàn thành trung bình (giờ)', null=True)),
                ('total_storage_used_mb', models.FloatField(default=0.0, help_text='Dung lượng lưu trữ sử dụng (MB)')),
                ('total_attachments_uploaded', models.PositiveIntegerField(default=0, help_text='Tổng số tệp đính kèm tải lên')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Platform Usage Statistics',
                'verbose_name_plural': 'Platform Usage Statistics',
                'db_table': 'cases_platformusagestatistics',
                'ordering': ['-period_start'],
            },
        ),
        migrations.CreateModel(
            name='Specialty',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Tên chuyên khoa bằng tiếng Việt (ví dụ: Tim mạch, Gan bướu, Hô hấp)', max_length=100, verbose_name='Tên chuyên khoa')),
                ('english_name', models.CharField(blank=True, help_text='Optional English translation (e.g., Cardiology, Hepatology, Pulmonology)', max_length=100, verbose_name='English name')),
                ('description', models.TextField(blank=True, help_text='Mô tả chi tiết về chuyên khoa này', verbose_name='Mô tả')),
                ('icon', models.CharField(blank=True, help_text='Tên icon để hiển thị trong giao diện (ví dụ: heart, lungs, liver)', max_length=50, verbose_name='Icon')),
                ('color', models.CharField(default='blue', help_text='Màu để hiển thị trong giao diện (red, blue, green, purple, orange)', max_length=20, verbose_name='Màu sắc')),
                ('is_active', models.BooleanField(default=True, help_text='Bỏ chọn để ẩn chuyên khoa này khỏi dropdown (không xóa dữ liệu cũ)', verbose_name='Đang hoạt động')),
                ('display_order', models.PositiveIntegerField(default=0, help_text='Chuyên khoa có số thứ tự nhỏ hơn sẽ hiển thị trước', verbose_name='Thứ tự hiển thị')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Ngày tạo')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Ngày cập nhật')),
            ],
            options={
                'verbose_name': 'Chuyên khoa',
                'verbose_name_plural': 'Chuyên khoa',
                'db_table': 'specialties',
                'ordering': ['department', 'display_order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='StudentEngagementMetrics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('total_cases_viewed', models.PositiveIntegerField(default=0, help_text='Tổng số ca bệnh đã xem')),
                ('total_cases_completed', models.PositiveIntegerField(default=0, help_text='Tổng số ca bệnh hoàn thành')),
                ('total_cases_submitted', models.PositiveIntegerField(default=0, help_text='Tổng số ca bệnh đã nộp')),
                ('total_study_time_hours', models.FloatField(default=0.0, help_text='Tổng thời gian học (giờ)')),
                ('average_session_duration_minutes', models.FloatField(default=0.0, help_text='Thời lượng phiên trung bình (phút)')),
                ('last_active_at', models.DateTimeField(blank=True, help_text='Lần hoạt động cuối', null=True)),
                ('total_comments_made', models.PositiveIntegerField(default=0, help_text='Tổng số bình luận')),
                ('total_questions_asked', models.PositiveIntegerField(default=0, help_text='Tổng số câu hỏi')),
                ('total_feedback_received', models.PositiveIntegerField(default=0, help_text='Tổng số phản hồi nhận được')),
                ('average_grade', models.FloatField(blank=True, help_text='Điểm trung bình', null=True)),
                ('highest_grade', models.FloatField(blank=True, help_text='Điểm cao nhất', null=True)),
                ('lowest_grade', models.FloatField(blank=True, help_text='Điểm thấp nhất', null=True)),
                ('improvement_rate', models.FloatField(default=0.0, help_text='Tỷ lệ cải thiện (%)')),
                ('current_streak_days', models.PositiveIntegerField(default=0, help_text='Chuỗi ngày học liên tiếp hiện tại')),
                ('longest_streak_days', models.PositiveIntegerField(default=0, help_text='Chuỗi ngày học liên tiếp dài nhất')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Student Engagement Metrics',
                'verbose_name_plural': 'Student Engagement Metrics',
                'db_table': 'cases_studentengagementmetrics',
            },
        ),
        migrations.CreateModel(
            name='StudentNotes',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('clinical_assessment', models.TextField(blank=True, help_text="Student's initial clinical assessment and key findings")),
                ('differential_diagnosis', models.TextField(blank=True, help_text="Student's differential diagnosis list with reasoning")),
                ('treatment_plan', models.TextField(blank=True, help_text="Student's proposed treatment plan and management strategy")),
                ('learning_reflections', models.TextField(blank=True, help_text='What the student learned from this case')),
                ('questions_for_instructor', models.TextField(blank=True, help_text='Questions or areas where the student needs clarification')),
                ('challenges_faced', models.TextField(blank=True, help_text='Challenges or difficulties encountered during the case')),
                ('resources_used', models.TextField(blank=True, help_text='References, textbooks, or resources consulted')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_submitted', models.BooleanField(default=False, help_text='Whether these notes have been submitted for instructor review')),
                ('submitted_at', models.DateTimeField(blank=True, help_text='When the notes were submitted', null=True)),
            ],
            options={
                'verbose_name': 'Student Notes',
                'verbose_name_plural': 'Student Notes',
                'db_table': 'cases_studentnotes',
                'ordering': ['-updated_at'],
            },
        ),
        migrations.CreateModel(
            name='Case',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=300)),
                ('patient_name', models.CharField(help_text='Tên bệnh nhân (có thể ẩn danh)', max_length=200)),
                ('patient_age', models.PositiveIntegerField(help_text='Tuổi')),
                ('patient_gender', models.CharField(choices=[('male', 'Nam'), ('female', 'Nữ'), ('other', 'Khác'), ('not_specified', 'Không xác định')], help_text='Giới tính', max_length=20)),
                ('medical_record_number', models.CharField(blank=True, help_text='Số hồ sơ bệnh án (ẩn danh)', max_length=50)),
                ('admission_date', models.DateField(blank=True, help_text='Ngày nhập viện', null=True)),
                ('discharge_date', models.DateField(blank=True, help_text='Ngày xuất viện', null=True)),
                ('case_status', models.CharField(choices=[('draft', 'Bản nháp'), ('submitted', 'Đã nộp'), ('reviewed', 'Đã xem xét'), ('approved', 'Đã phê duyệt')], default='draft', max_length=20)),
                ('specialty', models.CharField(help_text='Chuyên khoa liên quan đến ca bệnh này', max_length=100)),
                ('priority_level', models.CharField(choices=[('low', 'Thấp'), ('medium', 'Trung bình'), ('high', 'Cao'), ('urgent', 'Khẩn cấp')], default='medium', help_text='Mức độ ưu tiên', max_length=20)),
                ('complexity_level', models.CharField(choices=[('basic', 'Cơ bản'), ('intermediate', 'Trung cấp'), ('advanced', 'Nâng cao'), ('expert', 'Chuyên gia')], default='basic', help_text='Mức độ phức tạp', max_length=20)),
                ('case_summary', models.TextField(blank=True, help_text='Tóm tắt ca bệnh')),
                ('learning_tags', models.CharField(blank=True, help_text='Tags học tập, phân cách bằng dấu phẩy', max_length=500)),
                ('estimated_study_hours', models.PositiveIntegerField(blank=True, help_text='Số giờ học ước tính', null=True)),
                ('patient_ethnicity', models.CharField(blank=True, help_text='Dân tộc bệnh nhân', max_length=50)),
                ('patient_occupation', models.CharField(blank=True, help_text='Nghề nghiệp bệnh nhân', max_length=100)),
                ('chief_complaint_brief', models.CharField(blank=True, help_text='Lý do khám ngắn gọn', max_length=200)),
                ('requires_follow_up', models.BooleanField(default=False, help_text='Yêu cầu theo dõi')),
                ('follow_up_date', models.DateField(blank=True, help_text='Ngày theo dõi', null=True)),
                ('is_public', models.BooleanField(default=False, help_text='Ca bệnh công khai')),
                ('is_archived', models.BooleanField(default=False, help_text='Đã lưu trữ')),
                ('view_count', models.PositiveIntegerField(default=0, help_text='Số lượt xem')),
                ('average_rating', models.FloatField(blank=True, help_text='Đánh giá trung bình', null=True)),
                ('keywords', models.CharField(blank=True, help_text='Từ khóa tìm kiếm, phân cách bằng dấu phẩy', max_length=500)),
                ('is_published_to_feed', models.BooleanField(default=False, help_text='Ca bệnh đã được xuất bản lên feed công khai')),
                ('published_to_feed_at', models.DateTimeField(blank=True, help_text='Thời điểm xuất bản lên feed', null=True)),
                ('feed_visibility', models.CharField(choices=[('department', 'Cùng khoa'), ('university', 'Toàn trường')], default='department', help_text='Phạm vi hiển thị trên feed công khai', max_length=20)),
                ('is_featured', models.BooleanField(default=False, help_text='Ca bệnh nổi bật (được chọn bởi giảng viên)')),
                ('reaction_count', models.PositiveIntegerField(default=0, help_text='Tổng số reactions (likes, loves, etc.)')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('submitted_at', models.DateTimeField(blank=True, null=True)),
                ('reviewed_at', models.DateTimeField(blank=True, null=True)),
                ('archived_at', models.DateTimeField(blank=True, null=True)),
                ('archived_by', models.ForeignKey(blank=True, help_text='Người lưu trữ ca bệnh', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='archived_cases', to=settings.AUTH_USER_MODEL)),
                ('published_by', models.ForeignKey(blank=True, help_text='Giảng viên xuất bản ca bệnh lên feed', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='published_feed_cases', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Hồ sơ bệnh án',
                'verbose_name_plural': 'Hồ sơ bệnh án',
                'db_table': 'cases_case',
                'ordering': ['-created_at'],
            },
        ),
    ]
